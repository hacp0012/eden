(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{425:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n(38);function o(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];$nuxt.$store.state.sse.addEventListener("state",(function(n){1==Number(n.data)&&(t(e),0!=e&&e.$axios.put("/v1/chats/sse/accept.php"))})),console.log("SSE: launched."),$nuxt.$store.state.sse.error=function(t){console.log("SSE: Error occured NETWORK ",t)}}},467:function(t,e,n){var content=n(519);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(23).default)("1d1b2073",content,!0,{sourceMap:!1})},518:function(t,e,n){"use strict";n(467)},519:function(t,e,n){var o=n(22)(!1);o.push([t.i,".text-shadow[data-v-cc7afb46]{text-shadow:#f7377a 1px 0 10px}.bottom-sheet-shadow[data-v-cc7afb46]{box-shadow:1px -10px 20px 13px #fdfdfd}",""]),t.exports=o},581:function(t,e,n){"use strict";n.r(e);var o=n(20),r=(n(73),n(38),n(13),n(425)),c={middleware:["auth"],data:function(){return{tab:"inbox",bottom_sheet:!1,inbox:[],invitations:[],invitationSelected:0}},fetch:function(){this.getInbox(),this.getInvitations()},mounted:function(){Object(r.a)((function(t){t.getInbox()}),this)},methods:{getInbox:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/v1/chats/index.php");case 3:200==(n=e.sent).status&&(o=n.data.sort((function(a,b){return Number(b.sent_time)-Number(a.sent_time)})),r=[],o.forEach((function(e){null==e.avatar||"null"==e.avatar?(e.avatar={normal:"avatars/large/".concat("m"==t.$store.state.account.gender?"chris.jpg":"lindsay.png"),thumbnail:"avatars/small/".concat("m"==t.$store.state.account.gender?"chris.jpg":"lindsay.png")},r.push(e)):(e.avatar={normal:t.$store.state.app.host+e.avatar.normal,thumbnail:t.$store.state.app.host+e.avatar.thumbnail},r.push(e))})),t.inbox=r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getInvitations:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/v1/chats/invitation/index.php");case 3:200==(n=e.sent).status&&(o=[],n.data.forEach((function(e){null==e.avatar||"null"==e.avatar?(e.avatar={normal:"avatars/large/".concat("m"==t.$store.state.account.gender?"chris.jpg":"lindsay.png"),thumbnail:"avatars/small/".concat("m"==t.$store.state.account.gender?"chris.jpg":"lindsay.png")},o.push(e)):(e.avatar={normal:t.$store.state.app.host+e.avatar.normal,thumbnail:t.$store.state.app.host+e.avatar.thumbnail},o.push(e))})),t.invitations=o),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},openChat:function(t){this.$router.push("/chats?ID="+t)},openProfile:function(t){this.$router.push("/view_profile?ID="+t)},openAction:function(t){this.bottom_sheet=!0,this.invitationSelected=t},acceptInvitation:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.bottom_sheet=!1,e.prev=1,e.next=4,t.$axios.post("/v1/chats/invitation/accept.php",{},{params:{ID:t.invitationSelected}});case 4:200==(n=e.sent).status&&"sent"==n.data.status&&(t.getInvitations(),t.getInbox(),console.log("invitation accepted")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()},canceleInvitation:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.bottom_sheet=!1,e.prev=1,e.next=4,t.$axios.post("/v1/chats/invitation/cancel.php",{},{params:{ID:t.invitationSelected}});case 4:200==(n=e.sent).status&&"canceled"==n.data.status&&(t.getInvitations(),console.log("invitation canceled")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()}}},v=(n(518),n(64)),l=n(100),d=n.n(l),m=n(356),h=n(361),x=n(357),_=n(359),f=n(351),w=n(468),I=n(452),k=n(165),V=n(426),C=n(362),$=n(135),y=n(233),E=n(459),N=n(445),D=n(461),S=n(366),j=n(462),L=n(460),A=n(358),R=n(420),T=n(80),O=n(360),B=n(571),z=n(572),P=n(591),M=n(524),G=n(525),component=Object(v.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-app-bar",{staticClass:"white rounded-b-lg",attrs:{app:"",color:"white","elevate-on-scroll":""},scopedSlots:t._u([{key:"extension",fn:function(){return[n("v-tabs",{attrs:{color:"grey"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[n("v-tabs-slider",{attrs:{color:"cyan"}}),t._v(" "),n("v-tab",{attrs:{href:"#inbox"}},[t._v("Inbox")]),t._v(" "),n("v-tab",{attrs:{href:"#invitations"}},[n("v-badge",{attrs:{color:"green",bordered:"",content:t.invitations.length,value:t.invitations.length}},[t._v("\n            Invitations\n          ")])],1)],1)]},proxy:!0}])},[n("v-app-bar-nav-icon",{on:{click:function(e){return t.$router.back()}}},[n("v-icon",[t._v("mdi-chevron-left")])],1),t._v(" "),n("v-app-bar-title",[n("span",{staticClass:"grey--text text-darken-2"},[n("span",{staticClass:"pink--text"},[t._v("E")]),t._v("DEN\n      ")])]),t._v(" "),n("v-spacer"),t._v(" "),n("nuxt-link",{attrs:{to:"profile"}},[n("v-avatar",{attrs:{size:"35px"}},[n("v-img",{attrs:{src:t.$store.state.account.avatar.thumbnail}})],1)],1)],1),t._v(" "),n("v-main",[n("v-container",{attrs:{fluid:""}},[n("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[n("v-tab-item",{attrs:{value:"inbox"}},[n("div",{staticClass:"grey--text text--darken-2 text-caption text-center"},[n("span",[t._v("\n              La boit de reception "),n("span",{staticClass:"pink--text"},[t._v("E")]),t._v("DENIENE\n            ")])]),t._v(" "),n("v-list",[n("v-list-item-group",t._l(t.inbox,(function(e,o){return n("div",{key:o,staticClass:"text-decoration-none"},[n("v-list-item",[n("v-list-item-avatar",{on:{click:function(n){return t.openProfile(e.receiver_id==t.$store.state.account.ID?e.sender_id:e.receiver_id)}}},[n("v-img",{attrs:{src:""+e.avatar.thumbnail}})],1),t._v(" "),n("v-list-item-content",{on:{click:function(n){return t.openChat(e.receiver_id==t.$store.state.account.ID?e.sender_id:e.receiver_id)}}},[n("v-list-item-title",{staticClass:"cyan--text"},[t._v("\n                      "+t._s(e.name)+"\n                    ")]),t._v(" "),n("v-list-item-subtitle",[n("span",{staticClass:"text--disabled"},[t._v(t._s(Number(e.sender_id)==t.$store.state.account.ID?"moi":"lui")+":")]),t._v("\n                      "+t._s(e.text)+"\n                    ")]),t._v(" "),n("v-list-item-subtitle",[n("div",{directives:[{name:"show",rawName:"v-show",value:e.online,expression:"mail.online"}],staticClass:"green--text"},[t._v("\n                        ENLIGNE\n                      ")])])],1),t._v(" "),n("v-list-item-action",{on:{click:function(n){return t.openProfile(e.receiver_id==t.$store.state.account.ID?e.sender_id:e.receiver_id)}}},[n("v-list-item-action-text",{staticClass:"text-right"},[n("div",{directives:[{name:"show",rawName:"v-show",value:0==e.read_time,expression:"mail.read_time == 0"}],staticClass:"\n                          green--text green\n                          lighten-5\n                          rounded-xl\n                          text-center\n                        "},[t._v("\n                        non lu\n                      ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:0!=e.read_time,expression:"mail.read_time != 0"}],staticClass:"grey--text"},[t._v("\n                        lu\n                      ")]),t._v(" "),n("div",[t._v(t._s(e.formated_time.split(" ")[0]))]),t._v(" "),n("div",[t._v(t._s(e.formated_time.split(" ")[1]))])])],1)],1)],1)})),0)],1),t._v(" "),n("v-row",{directives:[{name:"show",rawName:"v-show",value:0==t.inbox.length,expression:"inbox.length == 0"}],attrs:{align:"center",justify:"center"}},[n("v-col",[n("div",{staticClass:"text-body-1 text-center my-8"},[n("v-icon",{attrs:{size:"45px",color:"pink lighten-2"}},[t._v("\n                  mdi-message\n                ")]),t._v(" "),n("br"),t._v("\n                Ici aparaitrons vos messages, car pour l'instant la liste est\n                vide.\n                "),n("br"),t._v(" "),n("small",[t._v("\n                  une discussion commence que quand vous acceptez une\n                  invitation\n                ")])],1)])],1)],1),t._v(" "),n("v-tab-item",{attrs:{value:"invitations"}},[n("div",{staticClass:"grey--text text--darken-2 text-caption text-center"},[n("span",[t._v("\n              noue des relations dans le champ d'\n              "),n("span",{staticClass:"pink--text"},[t._v("E")]),t._v("DEN\n            ")])]),t._v(" "),n("v-list",[n("v-list-item-group",t._l(t.invitations,(function(e,o){return n("v-list-item",{key:o},[n("v-list-item-avatar",{on:{click:function(n){return t.openProfile(e.ID)}}},[n("v-img",{attrs:{src:e.avatar.thumbnail}})],1),t._v(" "),n("v-list-item-content",{on:{click:function(n){return t.openAction(e.ID)}}},[n("v-list-item-title",{},[t._v("\n                    "+t._s(e.name)+"\n                  ")]),t._v(" "),n("v-list-item-subtitle",[n("span",{staticClass:"pink--text text--lighten-3"},[t._v("\n                      "+t._s(e.location)+"\n                    ")])])],1),t._v(" "),n("v-list-item-action",{on:{click:function(n){return t.openAction(e.ID)}}},[n("v-list-item-action-text",{staticClass:"text-right"},[n("div",{staticClass:"text-h5 pink--text text-lighten-2 text-shadow"},[t._v("\n                      "+t._s(e.age)+"\n                    ")])])],1)],1)})),1)],1),t._v(" "),n("v-row",{directives:[{name:"show",rawName:"v-show",value:0==t.invitations.length,expression:"invitations.length == 0"}],attrs:{align:"center",justify:"center"}},[n("v-col",[n("div",{staticClass:"text-body-1 text-center my-8"},[n("v-icon",{attrs:{size:"45px",color:"green lighten-2"}},[t._v("mdi-tag")]),t._v(" "),n("br"),t._v("\n                Ici aparaitrons vos invitations, car pour l'instant la liste\n                est vide.\n                "),n("br"),t._v(" "),n("small",[t._v("\n                  une discussion commence que quand vous acceptez une\n                  invitation\n                ")])],1)])],1)],1)],1)],1),t._v(" "),n("v-bottom-sheet",{staticClass:"rounded-t-xl",attrs:{"overlay-opacity":"0.1"},model:{value:t.bottom_sheet,callback:function(e){t.bottom_sheet=e},expression:"bottom_sheet"}},[n("v-sheet",{staticClass:"bottom-sheet-shadow"},[n("v-container",{staticClass:"m-3",attrs:{fluid:""}},[n("v-btn",{attrs:{rounded:"",elevation:"0",width:"100%",color:"green--text"},on:{click:t.acceptInvitation}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-thumb-up")]),t._v("\n            accepter l'invitation\n          ")],1),t._v(" "),n("v-btn",{staticClass:"my-4",attrs:{rounded:"",elevation:"0",width:"100%",color:"red--text"},on:{click:t.canceleInvitation}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-trash-can-outline")]),t._v("\n            rejeter l'invitation\n          ")],1)],1)],1)],1)],1)],1)}),[],!1,null,"cc7afb46",null);e.default=component.exports;d()(component,{VApp:m.a,VAppBar:h.a,VAppBarNavIcon:x.a,VAppBarTitle:_.a,VAvatar:f.a,VBadge:w.a,VBottomSheet:I.a,VBtn:k.a,VCol:V.a,VContainer:C.a,VIcon:$.a,VImg:y.a,VList:E.a,VListItem:N.a,VListItemAction:D.a,VListItemActionText:S.a,VListItemAvatar:j.a,VListItemContent:S.b,VListItemGroup:L.a,VListItemSubtitle:S.c,VListItemTitle:S.d,VMain:A.a,VRow:R.a,VSheet:T.a,VSpacer:O.a,VTab:B.a,VTabItem:z.a,VTabs:P.a,VTabsItems:M.a,VTabsSlider:G.a})}}]);